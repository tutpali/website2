---
import type { Product } from '../lib/products';

interface Props {
  product: Product;
  isCombo?: boolean;
}

const { product, isCombo = false } = Astro.props;
const discountPercentage = product.originalPrice 
  ? Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100)
  : 0;
---

<div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group">
  <!-- Product Image -->
  <div class="relative overflow-hidden">
    <img 
      src={product.image} 
      alt={product.name}
      class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
    />
    {isCombo && (
      <div class="absolute top-4 left-4 bg-accent-500 text-white px-3 py-1 rounded-full text-sm font-medium">
        Save ${product.originalPrice! - product.price}
      </div>
    )}
    {discountPercentage > 0 && (
      <div class="absolute top-4 right-4 bg-red-500 text-white px-2 py-1 rounded-full text-sm font-bold">
        -{discountPercentage}%
      </div>
    )}
  </div>

  <!-- Product Details -->
  <div class="p-6">
    <h3 class="text-xl font-heading font-bold text-gray-900 mb-2">
      {product.name}
    </h3>
    
    <p class="text-gray-600 text-sm mb-4 line-clamp-3">
      {product.description}
    </p>

    <!-- Price -->
    <div class="flex items-center mb-4">
      <span class="text-2xl font-bold text-red-600">${product.price}</span>
      {product.originalPrice && (
        <span class="text-lg text-gray-400 line-through ml-2">${product.originalPrice}</span>
      )}
    </div>

    <!-- Benefits -->
    {product.benefits && product.benefits.length > 0 && (
      <div class="mb-4">
        <h4 class="text-sm font-semibold text-gray-700 mb-2">Key Benefits:</h4>
        <ul class="text-sm text-gray-600 space-y-1">
          {product.benefits.slice(0, 3).map(benefit => (
            <li class="flex items-center">
              <svg class="w-3 h-3 text-green-500 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
              </svg>
              {benefit}
            </li>
          ))}
        </ul>
      </div>
    )}

    <!-- Add to Cart Button -->
    <button
      class="w-full bg-gray-400 text-white py-3 px-4 rounded-lg cursor-not-allowed font-medium"
      disabled
    >
      Add to Cart - ${product.price} (Coming Soon)
    </button>

    <!-- View Details Link -->
    <a 
      href={`/products/${product.id}`}
      class="block text-center text-red-600 hover:text-red-700 text-sm font-medium mt-3 transition-colors"
    >
      View Full Details â†’
    </a>
  </div>
</div>

<style>
.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
</style>